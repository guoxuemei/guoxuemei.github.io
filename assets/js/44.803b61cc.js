(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{327:function(t,a,s){"use strict";s.r(a);var n=s(10),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"vue2-vs-vue3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue2-vs-vue3"}},[t._v("#")]),t._v(" Vue2 vs Vue3")]),t._v(" "),a("h3",{attrs:{id:"_1-响应式实现方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-响应式实现方式"}},[t._v("#")]),t._v(" 1. 响应式实现方式")]),t._v(" "),a("p",[t._v("vue2 使用 Object.defineProperty,来为组件对象的 data 对象的每个属性添加监听,设置 get 和 set,并且在 set 中添加了通知机制")]),t._v(" "),a("ol",[a("li",[t._v("对象新增/删除属性,无法触发 set,需要Vue.set方法实现")]),t._v(" "),a("li",[t._v("基于性能和用户体验的性价比,vue2 没有为数组的下标添加监听, 但是为数组的每个元素又使用了Object.defineProperty, vue2底层处理了常用的七个数组方法,使用这几个方法可以正常处理响应式")])]),t._v(" "),a("p",[t._v("vue3 使用了 es6 中的 Proxy, 把对象类型包装成一个代理对象,针对这个对象的增删改查,都可以被监测到")]),t._v(" "),a("ul",[a("li",[t._v("reactive方法里面使用了 new Proxy")]),t._v(" "),a("li",[t._v("针对基本数据类型,提供了 ref 包装,添加了 get value,和 set value,操作 ref 对象要使用"),a("code",[t._v(".value")]),t._v("获取真实值")])]),t._v(" "),a("h3",{attrs:{id:"_2-mixin-vs-composition-function"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-mixin-vs-composition-function"}},[t._v("#")]),t._v(" 2.mixin vs composition function")]),t._v(" "),a("p",[t._v("vue2 的组件,是以对象形式表达,想复用功能,就没办法往对象里对应的属性上添加,\n使用mixin字段,动态将 mixin 里的各字段进行添加,合并")]),t._v(" "),a("p",[t._v("缺点: 数据来源不清晰,有同名冲突的可能")]),t._v(" "),a("p",[t._v("组合式函数,利用组合式api,封装和复用"),a("code",[t._v("有状态逻辑")]),t._v("的函数")]),t._v(" "),a("h3",{attrs:{id:"_3-v-if-和-v-for"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-v-if-和-v-for"}},[t._v("#")]),t._v(" 3.v-if 和 v-for")]),t._v(" "),a("p",[t._v("vue2 中,v-for 优先级较 v-if 高,一起使用会先执行循环,拿到 item,再去判断是否显示该 item,如果要隐藏,会导致浪费,不建议一起使用\n可以将数据提前进行一个 filter,然后在 v-for 渲染")]),t._v(" "),a("p",[t._v("vue3 中 v-if 的优先级更高,和 v-for 一起使用时,v-if 无法使用循环变量,会报错,因为v-if 先执行,v-for 还没执行呢")]),t._v(" "),a("p",[t._v("可以将 v-for 作用于 template,然后在使用 v-if,不过还是回到 vue2 的性能考虑问题")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-for")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("todo in todos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("li")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-if")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("!todo.isComplete"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    {{ todo.name }}\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h3",{attrs:{id:"_4-根元素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-根元素"}},[t._v("#")]),t._v(" 4. 根元素")]),t._v(" "),a("p",[t._v("vue3 不要求template单根节点了,大部分情况下多包一层,是种浪费")]),t._v(" "),a("p",[t._v("但也衍生出新的问题:\n父组件通过在子组件身上设置class,style,自定义事件,应该作用于哪个节点呢")]),t._v(" "),a("p",[t._v("单根节点组件,有个自动透传行为,可以配置是否自动透传"),a("code",[t._v("inheritAttrs")]),t._v(",")]),t._v(" "),a("ul",[a("li",[t._v("为 true 则透传进来的属性会合并到当前节点元素上,外部透传属性优先级要高于组件内部定义的 class 等")]),t._v(" "),a("li",[t._v("为 false 则传入组件的 class,style,自定义事件存储于"),a("code",[t._v("$attrs")]),t._v("上,选择性使用")])]),t._v(" "),a("p",[t._v("多根节点没有自动透传,需要使用"),a("code",[t._v('v-bind="$attrs"')]),t._v("显式绑定到哪个根节点上")]),t._v(" "),a("h3",{attrs:{id:"_5-模板引用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-模板引用"}},[t._v("#")]),t._v(" 5.模板引用")]),t._v(" "),a("p",[t._v('vue2 直接在元素或组件上设置 ref="someid",然后通过$refs.someid获取,操作dom')]),t._v(" "),a("p",[t._v("vue3,使用 ref 创建引用对象,绑定到元素上, v-for使用一个 ref([])数组引用")]),t._v(" "),a("h3",{attrs:{id:"_6-组件上的-v-model"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-组件上的-v-model"}},[t._v("#")]),t._v(" 6. 组件上的 v-model")]),t._v(" "),a("p",[t._v("vue 实现了表单元素的 v-model,我们也可以做组件的 v-model")]),t._v(" "),a("p",[t._v("核心 就是绑定一个 modelValue,触发一个update:modelValue事件,命名格式要求")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("CustomInput")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-model")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("searchText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- CustomInput.vue --\x3e")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'modelValue'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineEmits")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'update:modelValue'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("modelValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@input")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("$emit('update:modelValue', $event.target.value)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("MyComponent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("v-model:")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("bookTitle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\nvue\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- MyComponent.vue --\x3e")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//默认收集 modelValue, 可以自定义argument值")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'title'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineEmits")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'update:title'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("title"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@input")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("$emit('update:title', $event.target.value)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h3",{attrs:{id:"_7-组合式api-和-script-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-组合式api-和-script-setup"}},[t._v("#")]),t._v(" 7. 组合式api 和 "),a("code",[t._v("<script setup>")])]),t._v(" "),a("p",[t._v("组合式api 提供了 setup 函数,将属于同一块业务的数据,方法,归集到一起,在这里取代了 beforeCreate,created 钩子")]),t._v(" "),a("p",[a("code",[t._v("<script setup>")]),t._v(" 简化 setup 函数,定义完不用再手动暴露")]),t._v(" "),a("h3",{attrs:{id:"_8-自定义指令的钩子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-自定义指令的钩子"}},[t._v("#")]),t._v(" 8. 自定义指令的钩子")]),t._v(" "),a("p",[t._v("自定义指令用法大致如前,但是钩子发生了很大变化,有点形同于页面组件的钩子")]),t._v(" "),a("p",[t._v("具体说明看"),a("a",{attrs:{href:"https://cn.vuejs.org/guide/reusability/custom-directives.html#directive-hooks",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("去掉了 bind, inserted等,添加了 beforeMount, mounted, beforeUpdate, updated等")])])}),[],!1,null,null,null);a.default=e.exports}}]);